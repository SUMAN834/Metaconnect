{"ast":null,"code":"\"use strict\";\n\nvar __classPrivateFieldSet = this && this.__classPrivateFieldSet || function (receiver, state, value, kind, f) {\n  if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\n  if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\n  if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\n  return kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value), value;\n};\nvar __classPrivateFieldGet = this && this.__classPrivateFieldGet || function (receiver, state, kind, f) {\n  if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\n  if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\n  return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\n};\nvar _ModuleManager_ethAdapter, _ModuleManager_safeContract;\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nconst utils_1 = require(\"../utils\");\nconst constants_1 = require(\"../utils/constants\");\nclass ModuleManager {\n  constructor(ethAdapter, safeContract) {\n    _ModuleManager_ethAdapter.set(this, void 0);\n    _ModuleManager_safeContract.set(this, void 0);\n    __classPrivateFieldSet(this, _ModuleManager_ethAdapter, ethAdapter, \"f\");\n    __classPrivateFieldSet(this, _ModuleManager_safeContract, safeContract, \"f\");\n  }\n  validateModuleAddress(moduleAddress) {\n    const isValidAddress = __classPrivateFieldGet(this, _ModuleManager_ethAdapter, \"f\").isAddress(moduleAddress);\n    if (!isValidAddress || (0, utils_1.isRestrictedAddress)(moduleAddress)) {\n      throw new Error('Invalid module address provided');\n    }\n  }\n  validateModuleIsNotEnabled(moduleAddress, modules) {\n    const moduleIndex = modules.findIndex(module => (0, utils_1.sameString)(module, moduleAddress));\n    const isEnabled = moduleIndex >= 0;\n    if (isEnabled) {\n      throw new Error('Module provided is already enabled');\n    }\n  }\n  validateModuleIsEnabled(moduleAddress, modules) {\n    const moduleIndex = modules.findIndex(module => (0, utils_1.sameString)(module, moduleAddress));\n    const isEnabled = moduleIndex >= 0;\n    if (!isEnabled) {\n      throw new Error('Module provided is not enabled yet');\n    }\n    return moduleIndex;\n  }\n  async getModules() {\n    return __classPrivateFieldGet(this, _ModuleManager_safeContract, \"f\").getModules();\n  }\n  async isModuleEnabled(moduleAddress) {\n    return __classPrivateFieldGet(this, _ModuleManager_safeContract, \"f\").isModuleEnabled(moduleAddress);\n  }\n  async encodeEnableModuleData(moduleAddress) {\n    this.validateModuleAddress(moduleAddress);\n    const modules = await this.getModules();\n    this.validateModuleIsNotEnabled(moduleAddress, modules);\n    return __classPrivateFieldGet(this, _ModuleManager_safeContract, \"f\").encode('enableModule', [moduleAddress]);\n  }\n  async encodeDisableModuleData(moduleAddress) {\n    this.validateModuleAddress(moduleAddress);\n    const modules = await this.getModules();\n    const moduleIndex = this.validateModuleIsEnabled(moduleAddress, modules);\n    const prevModuleAddress = moduleIndex === 0 ? constants_1.SENTINEL_ADDRESS : modules[moduleIndex - 1];\n    return __classPrivateFieldGet(this, _ModuleManager_safeContract, \"f\").encode('disableModule', [prevModuleAddress, moduleAddress]);\n  }\n}\n_ModuleManager_ethAdapter = new WeakMap(), _ModuleManager_safeContract = new WeakMap();\nexports.default = ModuleManager;","map":{"version":3,"names":["utils_1","require","constants_1","ModuleManager","constructor","ethAdapter","safeContract","_ModuleManager_ethAdapter","set","_ModuleManager_safeContract","__classPrivateFieldSet","validateModuleAddress","moduleAddress","isValidAddress","__classPrivateFieldGet","isAddress","isRestrictedAddress","Error","validateModuleIsNotEnabled","modules","moduleIndex","findIndex","module","sameString","isEnabled","validateModuleIsEnabled","getModules","isModuleEnabled","encodeEnableModuleData","encode","encodeDisableModuleData","prevModuleAddress","SENTINEL_ADDRESS","exports","default"],"sources":["../../../src/managers/moduleManager.ts"],"sourcesContent":[null],"mappings":";;;;;;;;;;;;;;;;;AACA,MAAAA,OAAA,GAAAC,OAAA;AACA,MAAAC,WAAA,GAAAD,OAAA;AAEA,MAAME,aAAa;EAIjBC,YAAYC,UAAsB,EAAEC,YAAgC;IAHpEC,yBAAA,CAAAC,GAAA;IACAC,2BAAA,CAAAD,GAAA;IAGEE,sBAAA,KAAI,EAAAH,yBAAA,EAAeF,UAAU;IAC7BK,sBAAA,KAAI,EAAAD,2BAAA,EAAiBH,YAAY;EACnC;EAEQK,qBAAqBA,CAACC,aAAqB;IACjD,MAAMC,cAAc,GAAGC,sBAAA,KAAI,EAAAP,yBAAA,MAAY,CAACQ,SAAS,CAACH,aAAa,CAAC;IAChE,IAAI,CAACC,cAAc,IAAI,IAAAb,OAAA,CAAAgB,mBAAmB,EAACJ,aAAa,CAAC,EAAE;MACzD,MAAM,IAAIK,KAAK,CAAC,iCAAiC,CAAC;;EAEtD;EAEQC,0BAA0BA,CAACN,aAAqB,EAAEO,OAAiB;IACzE,MAAMC,WAAW,GAAGD,OAAO,CAACE,SAAS,CAAEC,MAAc,IAAK,IAAAtB,OAAA,CAAAuB,UAAU,EAACD,MAAM,EAAEV,aAAa,CAAC,CAAC;IAC5F,MAAMY,SAAS,GAAGJ,WAAW,IAAI,CAAC;IAClC,IAAII,SAAS,EAAE;MACb,MAAM,IAAIP,KAAK,CAAC,oCAAoC,CAAC;;EAEzD;EAEQQ,uBAAuBA,CAACb,aAAqB,EAAEO,OAAiB;IACtE,MAAMC,WAAW,GAAGD,OAAO,CAACE,SAAS,CAAEC,MAAc,IAAK,IAAAtB,OAAA,CAAAuB,UAAU,EAACD,MAAM,EAAEV,aAAa,CAAC,CAAC;IAC5F,MAAMY,SAAS,GAAGJ,WAAW,IAAI,CAAC;IAClC,IAAI,CAACI,SAAS,EAAE;MACd,MAAM,IAAIP,KAAK,CAAC,oCAAoC,CAAC;;IAEvD,OAAOG,WAAW;EACpB;EAEA,MAAMM,UAAUA,CAAA;IACd,OAAOZ,sBAAA,KAAI,EAAAL,2BAAA,MAAc,CAACiB,UAAU,EAAE;EACxC;EAEA,MAAMC,eAAeA,CAACf,aAAqB;IACzC,OAAOE,sBAAA,KAAI,EAAAL,2BAAA,MAAc,CAACkB,eAAe,CAACf,aAAa,CAAC;EAC1D;EAEA,MAAMgB,sBAAsBA,CAAChB,aAAqB;IAChD,IAAI,CAACD,qBAAqB,CAACC,aAAa,CAAC;IACzC,MAAMO,OAAO,GAAG,MAAM,IAAI,CAACO,UAAU,EAAE;IACvC,IAAI,CAACR,0BAA0B,CAACN,aAAa,EAAEO,OAAO,CAAC;IACvD,OAAOL,sBAAA,KAAI,EAAAL,2BAAA,MAAc,CAACoB,MAAM,CAAC,cAAc,EAAE,CAACjB,aAAa,CAAC,CAAC;EACnE;EAEA,MAAMkB,uBAAuBA,CAAClB,aAAqB;IACjD,IAAI,CAACD,qBAAqB,CAACC,aAAa,CAAC;IACzC,MAAMO,OAAO,GAAG,MAAM,IAAI,CAACO,UAAU,EAAE;IACvC,MAAMN,WAAW,GAAG,IAAI,CAACK,uBAAuB,CAACb,aAAa,EAAEO,OAAO,CAAC;IACxE,MAAMY,iBAAiB,GAAGX,WAAW,KAAK,CAAC,GAAGlB,WAAA,CAAA8B,gBAAgB,GAAGb,OAAO,CAACC,WAAW,GAAG,CAAC,CAAC;IACzF,OAAON,sBAAA,KAAI,EAAAL,2BAAA,MAAc,CAACoB,MAAM,CAAC,eAAe,EAAE,CAACE,iBAAiB,EAAEnB,aAAa,CAAC,CAAC;EACvF;;;AAGFqB,OAAA,CAAAC,OAAA,GAAe/B,aAAa"},"metadata":{},"sourceType":"script","externalDependencies":[]}