{"ast":null,"code":"\"use strict\";\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.generateTypedData = exports.getEip712MessageTypes = exports.EIP712_DOMAIN = exports.EIP712_DOMAIN_BEFORE_V130 = void 0;\nconst satisfies_1 = __importDefault(require(\"semver/functions/satisfies\"));\nconst EQ_OR_GT_1_3_0 = '>=1.3.0';\nexports.EIP712_DOMAIN_BEFORE_V130 = [{\n  type: 'address',\n  name: 'verifyingContract'\n}];\nexports.EIP712_DOMAIN = [{\n  type: 'uint256',\n  name: 'chainId'\n}, {\n  type: 'address',\n  name: 'verifyingContract'\n}];\n// This function returns the types structure for signing off-chain messages according to EIP-712\nfunction getEip712MessageTypes(safeVersion) {\n  const eip712WithChainId = (0, satisfies_1.default)(safeVersion, EQ_OR_GT_1_3_0);\n  return {\n    EIP712Domain: eip712WithChainId ? exports.EIP712_DOMAIN : exports.EIP712_DOMAIN_BEFORE_V130,\n    SafeTx: [{\n      type: 'address',\n      name: 'to'\n    }, {\n      type: 'uint256',\n      name: 'value'\n    }, {\n      type: 'bytes',\n      name: 'data'\n    }, {\n      type: 'uint8',\n      name: 'operation'\n    }, {\n      type: 'uint256',\n      name: 'safeTxGas'\n    }, {\n      type: 'uint256',\n      name: 'baseGas'\n    }, {\n      type: 'uint256',\n      name: 'gasPrice'\n    }, {\n      type: 'address',\n      name: 'gasToken'\n    }, {\n      type: 'address',\n      name: 'refundReceiver'\n    }, {\n      type: 'uint256',\n      name: 'nonce'\n    }]\n  };\n}\nexports.getEip712MessageTypes = getEip712MessageTypes;\nfunction generateTypedData({\n  safeAddress,\n  safeVersion,\n  chainId,\n  safeTransactionData\n}) {\n  const eip712WithChainId = (0, satisfies_1.default)(safeVersion, EQ_OR_GT_1_3_0);\n  const typedData = {\n    types: getEip712MessageTypes(safeVersion),\n    domain: {\n      verifyingContract: safeAddress\n    },\n    primaryType: 'SafeTx',\n    message: {\n      ...safeTransactionData,\n      value: safeTransactionData.value,\n      safeTxGas: safeTransactionData.safeTxGas,\n      baseGas: safeTransactionData.baseGas,\n      gasPrice: safeTransactionData.gasPrice,\n      nonce: safeTransactionData.nonce\n    }\n  };\n  if (eip712WithChainId) {\n    typedData.domain.chainId = chainId;\n  }\n  return typedData;\n}\nexports.generateTypedData = generateTypedData;","map":{"version":3,"names":["satisfies_1","__importDefault","require","EQ_OR_GT_1_3_0","exports","EIP712_DOMAIN_BEFORE_V130","type","name","EIP712_DOMAIN","getEip712MessageTypes","safeVersion","eip712WithChainId","default","EIP712Domain","SafeTx","generateTypedData","safeAddress","chainId","safeTransactionData","typedData","types","domain","verifyingContract","primaryType","message","value","safeTxGas","baseGas","gasPrice","nonce"],"sources":["../../../src/eip-712/index.ts"],"sourcesContent":[null],"mappings":";;;;;;;;;;;AACA,MAAAA,WAAA,GAAAC,eAAA,CAAAC,OAAA;AAEA,MAAMC,cAAc,GAAG,SAAS;AAEnBC,OAAA,CAAAC,yBAAyB,GAAG,CACvC;EACEC,IAAI,EAAE,SAAS;EACfC,IAAI,EAAE;CACP,CACF;AAEYH,OAAA,CAAAI,aAAa,GAAG,CAC3B;EACEF,IAAI,EAAE,SAAS;EACfC,IAAI,EAAE;CACP,EACD;EACED,IAAI,EAAE,SAAS;EACfC,IAAI,EAAE;CACP,CACF;AAED;AACA,SAAgBE,qBAAqBA,CAACC,WAAmB;EAIvD,MAAMC,iBAAiB,GAAG,IAAAX,WAAA,CAAAY,OAAe,EAACF,WAAW,EAAEP,cAAc,CAAC;EACtE,OAAO;IACLU,YAAY,EAAEF,iBAAiB,GAAGP,OAAA,CAAAI,aAAa,GAAGJ,OAAA,CAAAC,yBAAyB;IAC3ES,MAAM,EAAE,CACN;MAAER,IAAI,EAAE,SAAS;MAAEC,IAAI,EAAE;IAAI,CAAE,EAC/B;MAAED,IAAI,EAAE,SAAS;MAAEC,IAAI,EAAE;IAAO,CAAE,EAClC;MAAED,IAAI,EAAE,OAAO;MAAEC,IAAI,EAAE;IAAM,CAAE,EAC/B;MAAED,IAAI,EAAE,OAAO;MAAEC,IAAI,EAAE;IAAW,CAAE,EACpC;MAAED,IAAI,EAAE,SAAS;MAAEC,IAAI,EAAE;IAAW,CAAE,EACtC;MAAED,IAAI,EAAE,SAAS;MAAEC,IAAI,EAAE;IAAS,CAAE,EACpC;MAAED,IAAI,EAAE,SAAS;MAAEC,IAAI,EAAE;IAAU,CAAE,EACrC;MAAED,IAAI,EAAE,SAAS;MAAEC,IAAI,EAAE;IAAU,CAAE,EACrC;MAAED,IAAI,EAAE,SAAS;MAAEC,IAAI,EAAE;IAAgB,CAAE,EAC3C;MAAED,IAAI,EAAE,SAAS;MAAEC,IAAI,EAAE;IAAO,CAAE;GAErC;AACH;AApBAH,OAAA,CAAAK,qBAAA,GAAAA,qBAAA;AAsBA,SAAgBM,iBAAiBA,CAAC;EAChCC,WAAW;EACXN,WAAW;EACXO,OAAO;EACPC;AAAmB,CACO;EAC1B,MAAMP,iBAAiB,GAAG,IAAAX,WAAA,CAAAY,OAAe,EAACF,WAAW,EAAEP,cAAc,CAAC;EACtE,MAAMgB,SAAS,GAAsB;IACnCC,KAAK,EAAEX,qBAAqB,CAACC,WAAW,CAAC;IACzCW,MAAM,EAAE;MACNC,iBAAiB,EAAEN;KACpB;IACDO,WAAW,EAAE,QAAQ;IACrBC,OAAO,EAAE;MACP,GAAGN,mBAAmB;MACtBO,KAAK,EAAEP,mBAAmB,CAACO,KAAK;MAChCC,SAAS,EAAER,mBAAmB,CAACQ,SAAS;MACxCC,OAAO,EAAET,mBAAmB,CAACS,OAAO;MACpCC,QAAQ,EAAEV,mBAAmB,CAACU,QAAQ;MACtCC,KAAK,EAAEX,mBAAmB,CAACW;;GAE9B;EACD,IAAIlB,iBAAiB,EAAE;IACrBQ,SAAS,CAACE,MAAM,CAACJ,OAAO,GAAGA,OAAO;;EAEpC,OAAOE,SAAS;AAClB;AA1BAf,OAAA,CAAAW,iBAAA,GAAAA,iBAAA"},"metadata":{},"sourceType":"script","externalDependencies":[]}