{"ast":null,"code":"const EventEmitter = require('events');\nconst {\n  v4: uuid\n} = require('uuid');\nconst dev = process.env.NODE_ENV === 'development';\nlet XHR;\nclass HTTPConnection extends EventEmitter {\n  constructor(_XHR, url, options) {\n    super();\n    XHR = _XHR;\n    this.options = options;\n    this.connected = false;\n    this.subscriptions = false;\n    this.status = 'loading';\n    this.url = url;\n    this.pollId = uuid();\n    setTimeout(() => this.create(), 0);\n    this._emit = (...args) => !this.closed ? this.emit(...args) : null;\n  }\n  onError(err) {\n    if (!this.closed && this.listenerCount('error')) this.emit('error', err);\n  }\n  create() {\n    if (!XHR) return this.onError(new Error('No HTTP transport available'));\n    this.on('error', () => {\n      if (this.connected) this.close();\n    });\n    this.init();\n  }\n  init() {\n    this.send({\n      jsonrpc: '2.0',\n      method: 'net_version',\n      params: [],\n      id: 1\n    }, (err, response) => {\n      if (err) return this.onError(err);\n      this.connected = true;\n      this._emit('connect');\n      this.send({\n        jsonrpc: '2.0',\n        id: 1,\n        method: 'eth_pollSubscriptions',\n        params: [this.pollId, 'immediate']\n      }, (err, response) => {\n        if (!err) {\n          this.subscriptions = true;\n          this.pollSubscriptions();\n        }\n      });\n    });\n  }\n  pollSubscriptions() {\n    this.send({\n      jsonrpc: '2.0',\n      id: 1,\n      method: 'eth_pollSubscriptions',\n      params: [this.pollId]\n    }, (err, result) => {\n      if (err) {\n        this.subscriptionTimeout = setTimeout(() => this.pollSubscriptions(), 10000);\n        return this.onError(err);\n      } else {\n        if (!this.closed) this.subscriptionTimeout = this.pollSubscriptions();\n        if (result) {\n          result.map(p => {\n            let parse;\n            try {\n              parse = JSON.parse(p);\n            } catch (e) {\n              parse = false;\n            }\n            return parse;\n          }).filter(n => n).forEach(p => this._emit('payload', p));\n        }\n      }\n    });\n  }\n  close() {\n    if (dev) console.log('Closing HTTP connection');\n    clearTimeout(this.subscriptionTimeout);\n    this._emit('close');\n    this.closed = true;\n    this.removeAllListeners();\n  }\n  filterStatus(res) {\n    if (res.status >= 200 && res.status < 300) return res;\n    const error = new Error(res.statusText);\n    error.res = res;\n    throw error.message;\n  }\n  error(payload, message, code = -1) {\n    this._emit('payload', {\n      id: payload.id,\n      jsonrpc: payload.jsonrpc,\n      error: {\n        message,\n        code\n      }\n    });\n  }\n  send(payload, internal) {\n    if (this.closed) return this.error(payload, 'Not connected');\n    if (payload.method === 'eth_subscribe') {\n      if (this.subscriptions) {\n        payload.pollId = this.pollId;\n      } else {\n        return this.error(payload, 'Subscriptions are not supported by this HTTP endpoint');\n      }\n    }\n    const xhr = new XHR();\n    let responded = false;\n    const res = (err, result) => {\n      if (!responded) {\n        xhr.abort();\n        responded = true;\n        if (internal) {\n          internal(err, result);\n        } else {\n          const {\n            id,\n            jsonrpc\n          } = payload;\n          const load = err ? {\n            id,\n            jsonrpc,\n            error: {\n              message: err.message,\n              code: err.code\n            }\n          } : {\n            id,\n            jsonrpc,\n            result\n          };\n          this._emit('payload', load);\n        }\n      }\n    };\n    try {\n      xhr.open('POST', this.url, true);\n      xhr.setRequestHeader('Content-Type', 'application/json');\n      // Below not working becasue XHR lib blocks it claiming \"restricted header\"\n      // if (this.options.origin) xhr.setRequestHeader('Origin', this.options.origin)\n      xhr.timeout = 60 * 1000;\n      xhr.onerror = res;\n      xhr.ontimeout = res;\n      xhr.onreadystatechange = () => {\n        if (xhr.readyState === 4) {\n          try {\n            const response = JSON.parse(xhr.responseText);\n            res(response.error, response.result);\n          } catch (e) {\n            res(e);\n          }\n        }\n      };\n      xhr.send(JSON.stringify(payload));\n    } catch (e) {\n      if (dev) console.error('Error sending HTTP request', e);\n      res({\n        message: e.message,\n        code: -1\n      });\n    }\n  }\n}\nmodule.exports = XHR => (url, options) => new HTTPConnection(XHR, url, options);","map":{"version":3,"names":["EventEmitter","require","v4","uuid","dev","process","env","NODE_ENV","XHR","HTTPConnection","constructor","_XHR","url","options","connected","subscriptions","status","pollId","setTimeout","create","_emit","args","closed","emit","onError","err","listenerCount","Error","on","close","init","send","jsonrpc","method","params","id","response","pollSubscriptions","result","subscriptionTimeout","map","p","parse","JSON","e","filter","n","forEach","console","log","clearTimeout","removeAllListeners","filterStatus","res","error","statusText","message","payload","code","internal","xhr","responded","abort","load","open","setRequestHeader","timeout","onerror","ontimeout","onreadystatechange","readyState","responseText","stringify","module","exports"],"sources":["C:/Users/SUMAN K/meta_transfer/node_modules/eth-provider/connections/http.js"],"sourcesContent":["const EventEmitter = require('events')\nconst { v4: uuid } = require('uuid')\n\nconst dev = process.env.NODE_ENV === 'development'\n\nlet XHR\n\nclass HTTPConnection extends EventEmitter {\n  constructor (_XHR, url, options) {\n    super()\n    XHR = _XHR\n    this.options = options\n    this.connected = false\n    this.subscriptions = false\n    this.status = 'loading'\n    this.url = url\n    this.pollId = uuid()\n    setTimeout(() => this.create(), 0)\n    this._emit = (...args) => !this.closed ? this.emit(...args) : null\n  }\n\n  onError (err) {\n    if (!this.closed && this.listenerCount('error')) this.emit('error', err)\n  }\n\n  create () {\n    if (!XHR) return this.onError(new Error('No HTTP transport available'))\n    this.on('error', () => { if (this.connected) this.close() })\n    this.init()\n  }\n\n  init () {\n    this.send({ jsonrpc: '2.0', method: 'net_version', params: [], id: 1 }, (err, response) => {\n      if (err) return this.onError(err)\n      this.connected = true\n      this._emit('connect')\n      this.send({ jsonrpc: '2.0', id: 1, method: 'eth_pollSubscriptions', params: [this.pollId, 'immediate'] }, (err, response) => {\n        if (!err) {\n          this.subscriptions = true\n          this.pollSubscriptions()\n        }\n      })\n    })\n  }\n\n  pollSubscriptions () {\n    this.send({ jsonrpc: '2.0', id: 1, method: 'eth_pollSubscriptions', params: [this.pollId] }, (err, result) => {\n      if (err) {\n        this.subscriptionTimeout = setTimeout(() => this.pollSubscriptions(), 10000)\n        return this.onError(err)\n      } else {\n        if (!this.closed) this.subscriptionTimeout = this.pollSubscriptions()\n        if (result) {\n          result.map(p => {\n            let parse\n            try { parse = JSON.parse(p) } catch (e) { parse = false }\n            return parse\n          }).filter(n => n).forEach(p => this._emit('payload', p))\n        }\n      }\n    })\n  }\n\n  close () {\n    if (dev) console.log('Closing HTTP connection')\n\n    clearTimeout(this.subscriptionTimeout)\n\n    this._emit('close')\n    this.closed = true\n    this.removeAllListeners()\n  }\n\n  filterStatus (res) {\n    if (res.status >= 200 && res.status < 300) return res\n    const error = new Error(res.statusText)\n    error.res = res\n    throw error.message\n  }\n\n  error (payload, message, code = -1) {\n    this._emit('payload', { id: payload.id, jsonrpc: payload.jsonrpc, error: { message, code } })\n  }\n\n  send (payload, internal) {\n    if (this.closed) return this.error(payload, 'Not connected')\n    if (payload.method === 'eth_subscribe') {\n      if (this.subscriptions) {\n        payload.pollId = this.pollId\n      } else {\n        return this.error(payload, 'Subscriptions are not supported by this HTTP endpoint')\n      }\n    }\n\n    const xhr = new XHR()\n    let responded = false\n    const res = (err, result) => {\n      if (!responded) {\n        xhr.abort()\n        responded = true\n        if (internal) {\n          internal(err, result)\n        } else {\n          const { id, jsonrpc } = payload\n          const load = err ? { id, jsonrpc, error: { message: err.message, code: err.code } } : { id, jsonrpc, result }\n          this._emit('payload', load)\n        }\n      }\n    }\n\n    try {\n      xhr.open('POST', this.url, true)\n      xhr.setRequestHeader('Content-Type', 'application/json')\n      // Below not working becasue XHR lib blocks it claiming \"restricted header\"\n      // if (this.options.origin) xhr.setRequestHeader('Origin', this.options.origin)\n      xhr.timeout = 60 * 1000\n      xhr.onerror = res\n      xhr.ontimeout = res\n      xhr.onreadystatechange = () => {\n        if (xhr.readyState === 4) {\n          try {\n            const response = JSON.parse(xhr.responseText)\n            res(response.error, response.result)\n          } catch (e) {\n            res(e)\n          }\n        }\n      }\n      xhr.send(JSON.stringify(payload))\n    } catch (e) {\n      if (dev) console.error('Error sending HTTP request', e)\n\n      res({ message: e.message, code: -1 })\n    }\n  }\n}\n\nmodule.exports = XHR => (url, options) => new HTTPConnection(XHR, url, options)\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}