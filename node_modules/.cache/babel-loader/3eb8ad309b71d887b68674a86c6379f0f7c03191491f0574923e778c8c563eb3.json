{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.mapReceipt = exports.createLibInterface = exports.createLibAddress = exports.createLibDeployment = void 0;\nconst abi_1 = require(\"@ethersproject/abi\");\nconst address_1 = require(\"@ethersproject/address\");\nconst safe_deployments_1 = require(\"@safe-global/safe-deployments\");\nexports.createLibDeployment = (0, safe_deployments_1.getCreateCallDeployment)();\nexports.createLibAddress = exports.createLibDeployment.defaultAddress;\nexports.createLibInterface = new abi_1.Interface(exports.createLibDeployment.abi);\nconst mapStatus = receipt => {\n  // Search for ExecutionSuccess event (see https://github.com/safe-global/safe-contracts/blob/v1.3.0/contracts/GnosisSafe.sol#L49)\n  const success = receipt.logs.find(log => log.topics[0] === '0x442e715f626346e8c54381002da614f62bee8d27386535b2521ec8540898556e');\n  return !!success ? 1 : 0;\n};\nconst mapContractAddress = (receipt, safeTx) => {\n  if (safeTx.to.toLowerCase() === exports.createLibAddress.toLowerCase()) {\n    // Search for ContractCreation event (see https://github.com/safe-global/safe-contracts/blob/v1.3.0/contracts/libraries/CreateCall.sol#L7)\n    const creationLog = receipt.logs.find(log => log.topics[0] === '0x4db17dd5e4732fb6da34a148104a592783ca119a1e7bb8829eba6cbadef0b511');\n    if (creationLog) return (0, address_1.getAddress)('0x' + creationLog.data.slice(creationLog.data.length - 40));\n  }\n  return receipt.contractAddress;\n};\nconst mapReceipt = (receipt, safeTx) => {\n  // Update status with Safe tx status and extract created contract\n  receipt.status = mapStatus(receipt);\n  receipt.contractAddress = mapContractAddress(receipt, safeTx);\n  return receipt;\n};\nexports.mapReceipt = mapReceipt;","map":{"version":3,"names":["abi_1","require","address_1","safe_deployments_1","exports","createLibDeployment","getCreateCallDeployment","createLibAddress","defaultAddress","createLibInterface","Interface","abi","mapStatus","receipt","success","logs","find","log","topics","mapContractAddress","safeTx","to","toLowerCase","creationLog","getAddress","data","slice","length","contractAddress","mapReceipt","status"],"sources":["../../src/utils.ts"],"sourcesContent":[null],"mappings":";;;;;;AAAA,MAAAA,KAAA,GAAAC,OAAA;AAEA,MAAAC,SAAA,GAAAD,OAAA;AACA,MAAAE,kBAAA,GAAAF,OAAA;AAGaG,OAAA,CAAAC,mBAAmB,GAAG,IAAAF,kBAAA,CAAAG,uBAAuB,GAAE;AAC/CF,OAAA,CAAAG,gBAAgB,GAAGH,OAAA,CAAAC,mBAAqB,CAACG,cAAc;AACvDJ,OAAA,CAAAK,kBAAkB,GAAG,IAAIT,KAAA,CAAAU,SAAS,CAACN,OAAA,CAAAC,mBAAqB,CAACM,GAAG,CAAC;AAE1E,MAAMC,SAAS,GAAIC,OAA2B,IAAY;EACxD;EACA,MAAMC,OAAO,GAAGD,OAAO,CAACE,IAAI,CAACC,IAAI,CAC9BC,GAAQ,IACPA,GAAG,CAACC,MAAM,CAAC,CAAC,CAAC,KAAK,oEAAoE,CACzF;EACD,OAAO,CAAC,CAACJ,OAAO,GAAG,CAAC,GAAG,CAAC;AAC1B,CAAC;AAED,MAAMK,kBAAkB,GAAGA,CAACN,OAA2B,EAAEO,MAA2B,KAAY;EAC9F,IAAIA,MAAM,CAACC,EAAE,CAACC,WAAW,EAAE,KAAKlB,OAAA,CAAAG,gBAAgB,CAACe,WAAW,EAAE,EAAE;IAC9D;IACA,MAAMC,WAAW,GAAGV,OAAO,CAACE,IAAI,CAACC,IAAI,CAClCC,GAAQ,IACPA,GAAG,CAACC,MAAM,CAAC,CAAC,CAAC,KAAK,oEAAoE,CACzF;IACD,IAAIK,WAAW,EAAE,OAAO,IAAArB,SAAA,CAAAsB,UAAU,EAAC,IAAI,GAAGD,WAAW,CAACE,IAAI,CAACC,KAAK,CAACH,WAAW,CAACE,IAAI,CAACE,MAAM,GAAG,EAAE,CAAC,CAAC;;EAEjG,OAAOd,OAAO,CAACe,eAAe;AAChC,CAAC;AAEM,MAAMC,UAAU,GAAGA,CAAChB,OAA2B,EAAEO,MAA2B,KAAI;EACrF;EACAP,OAAO,CAACiB,MAAM,GAAGlB,SAAS,CAACC,OAAO,CAAC;EACnCA,OAAO,CAACe,eAAe,GAAGT,kBAAkB,CAACN,OAAO,EAAEO,MAAM,CAAC;EAC7D,OAAOP,OAAO;AAChB,CAAC;AALYT,OAAA,CAAAyB,UAAU,GAAAA,UAAA"},"metadata":{},"sourceType":"script","externalDependencies":[]}